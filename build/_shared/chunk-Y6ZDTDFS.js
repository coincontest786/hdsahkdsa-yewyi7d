import{c as R,d as f,y as P}from"/build/_shared/chunk-ZE7WC5SJ.js";import{d as h,g as C,i as g}from"/build/_shared/chunk-BQCUINC5.js";g();P();var l=h(C());var T=x=>{var I,S;let t=f(),p=R(),[e,d]=(0,l.useState)(),E=e?(I=e==null?void 0:e.redirects)==null?void 0:I.length:0,N=(e?(e==null?void 0:e.currentIndex)+1:0)/E*100;return(0,l.useEffect)(()=>{let o=localStorage.getItem("signup_redirects");if(o){let n=JSON.parse(o).startedAt,s=new Date(n).getTime(),c=new Date().getTime()-s,m=1e3*60*5;c>m?localStorage.removeItem("signup_redirects"):d(JSON.parse(o))}else e&&d(void 0)},[p]),{currentStep:(S=e==null?void 0:e.redirects)==null?void 0:S[e==null?void 0:e.currentIndex],redirects:e==null?void 0:e.redirects,progress:Number(N.toFixed(1)),nextPage:()=>{if(!Boolean(e))return t("/");let u=e.redirects.length-1;if(e.nextIndex>u)localStorage.removeItem("signup_redirects"),t("/");else{let n=localStorage.getItem("email"),s=n&&JSON.parse(n),r=e.redirects[e.nextIndex],c=r.managed_type==="custom",m=!r.full_url.startsWith(x.url);if(c&&m)try{let a=r.href,i=new URL(a);i.searchParams.set("email",s),window.open(i.href,"_blank"),localStorage.removeItem("signup_redirects"),t("/")}catch{localStorage.removeItem("signup_redirects"),t("/")}else if(c)localStorage.removeItem("signup_redirects"),t(r.href);else{let a=`${r.href}?email=${s}`,i={currentIndex:e.currentIndex+1,nextIndex:e.nextIndex+1,redirects:e.redirects};localStorage.setItem("signup_redirects",JSON.stringify(i)),t(a)}}}}},v=T;export{v as a};